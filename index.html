<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>AI ç‰›æ‡’è®¡ç®—å™¨2.0</title>

<style>

body{
background:#020617;
color:white;
font-family:Arial;
text-align:center;
margin:0;
}

header{
padding:18px;
font-size:26px;
background:#0f172a;
}

.container{
max-width:520px;
margin:auto;
padding:20px;
}

.cards{
display:flex;
justify-content:center;
gap:10px;
flex-wrap:wrap;
margin:20px 0;
min-height:100px;
}

.card{
background:white;
color:black;
width:65px;
height:90px;
border-radius:12px;
display:flex;
align-items:center;
justify-content:center;
font-size:22px;
font-weight:bold;
}

.ten{
background:#facc15;
}

.result{
font-size:36px;
color:#facc15;
margin:10px 0;
}

.ai{
border:1px solid #334155;
padding:14px;
border-radius:10px;
margin-top:10px;
color:#94a3b8;
}

.grid{
display:grid;
grid-template-columns:repeat(4,1fr);
gap:10px;
margin-top:20px;
}

button{
padding:16px;
font-size:18px;
border:none;
border-radius:10px;
background:#1f2937;
color:white;
}

.control{
margin-top:10px;
display:flex;
gap:10px;
}

.control button{
flex:1;
}

</style>
</head>

<body>

<header>ğŸ¤– AI ç‰›æ‡’è®¡ç®—å™¨2.0</header>

<div class="container">

<div class="cards" id="cards"></div>

<div class="result" id="result">
è¾“å…¥3æˆ–5å¼ ç‰Œ
</div>

<div class="ai" id="aiBox">
AIåˆ†æç­‰å¾…ä¸­...
</div>

<div class="grid" id="keys"></div>

<div class="control">
<button onclick="delCard()">åˆ é™¤</button>
<button onclick="reset()">é‡ç½®</button>
</div>

</div>

<script>

/* ç‰Œ */

const values=[
"A","2","3","4","5","6","7","8","9",
"10","J","Q","K","â™ A"
]

let cards=[]

const cardsDiv=document.getElementById("cards")
const result=document.getElementById("result")
const aiBox=document.getElementById("aiBox")
const keys=document.getElementById("keys")

values.forEach(v=>{
let b=document.createElement("button")
b.textContent=v
b.onclick=()=>addCard(v)
keys.appendChild(b)
})

/* æ¸²æŸ“ */

function render(list){

cardsDiv.innerHTML=""

list.forEach(c=>{
let d=document.createElement("div")
d.className="card"
d.textContent=c
cardsDiv.appendChild(d)
})

}

function renderCombo(top,bottom){

cardsDiv.innerHTML=""

top.forEach(c=>{
let d=document.createElement("div")
d.className="card"
d.textContent=c
cardsDiv.appendChild(d)
})

let br=document.createElement("div")
br.style.width="100%"
cardsDiv.appendChild(br)

bottom.forEach(c=>{
let d=document.createElement("div")
d.className="card ten"
d.textContent=c
cardsDiv.appendChild(d)
})

}

/* æ“ä½œ */

function addCard(v){

if(cards.length===5) return

cards.push(v)

render(cards)

calc()

}

function delCard(){

cards.pop()

render(cards)

calc()

}

function reset(){

cards=[]
cardsDiv.innerHTML=""
result.textContent="è¾“å…¥3æˆ–5å¼ ç‰Œ"
aiBox.textContent="AIåˆ†æç­‰å¾…ä¸­..."

}

/* ç‰Œå€¼ */

function val(v){

if(v==="A"||v==="â™ A") return 1
if(["J","Q","K"].includes(v)) return 10

return parseInt(v)

}

/* ä¸‰å¼ èµ”ç‡ */

function odds3(cards,best){

let face=cards.filter(c=>["J","Q","K"].includes(c))

if(face.length===3) return 2
if(best===10) return 2
if(best>0) return 1

return 0

}

/* äº”å¼ èµ”ç‡ */

function odds5(cards,best,combo){

let count={}
cards.forEach(c=>{
count[c]=(count[c]||0)+1
})

let face=cards.filter(c=>["J","Q","K"].includes(c))
if(face.length===5) return 5

for(let k in count){
if(count[k]===4) return 4
}

if(cards.includes("â™ A")){
if(cards.some(c=>["J","Q","K"].includes(c))) return 3
}

let top=cards.filter((c,i)=>!combo.includes(i))
let f=top.filter(c=>["J","Q","K"].includes(c)).length
if(f>=3) return 3

if(best===10) return 2
if(best>0) return 1

return 0

}

/* ç”Ÿæˆ 3/6 å˜ç‰Œ */

function generateVariants(nums){

let res=[[]]

nums.forEach(n=>{

let temp=[]

res.forEach(r=>{

if(n===3 || n===6){

temp.push([...r,3])
temp.push([...r,6])

}else{

temp.push([...r,n])

}

})

res=temp

})

return res

}

/* äº”å¼ ç®—ç‰› */

function score(nums){

let best=0
let bestCombo=null

let variants=generateVariants(nums)

variants.forEach(arr=>{

for(let i=0;i<3;i++){
for(let j=i+1;j<4;j++){
for(let k=j+1;k<5;k++){

let sum=arr[i]+arr[j]+arr[k]

if(sum%10===0){

let rest=[]

for(let x=0;x<5;x++){
if(x!==i&&x!==j&&x!==k){
rest.push(arr[x])
}
}

let n=(rest[0]+rest[1])%10
if(n===0) n=10

if(n>best){
best=n
bestCombo=[i,j,k]
}

}

}
}
}

})

return {value:best,combo:bestCombo}

}

/* ä¸»è®¡ç®— */

function calc(){

let nums=cards.map(val)

/* å°‘äº3å¼  */

if(cards.length<3){

aiBox.textContent="AIè§‚å¯Ÿä¸­..."
return

}

/* ä¸‰å¼  */

if(cards.length===3){

let sum=nums[0]+nums[1]+nums[2]
let best=sum%10
if(best===0) best=10

let odds=odds3(cards,best)

let name=""

if(best===0) name="æ²¡ç‰›"
else if(best===10) name="ğŸ‚ ç‰›ç‰›"
else name="ç‰› "+best

result.textContent=name+" (èµ”ç‡ "+odds+"å€)"

aiBox.textContent="AIæ­£åœ¨åˆ†æ..."

return

}

/* å››å¼  */

if(cards.length===4){

aiBox.textContent="ç­‰å¾…æœ€åä¸€å¼ ç‰Œ..."

return

}

/* äº”å¼  */

if(cards.length===5){

let r=score(nums)

let best=r.value
let combo=r.combo

if(best===0){

render(cards)

result.textContent="æ²¡ç‰› (èµ”ç‡ 0å€)"

aiBox.textContent="AIå·²é‡æ–°è®¡ç®—"

return

}

let top=[]
let bottom=[]

for(let i=0;i<5;i++){

if(combo.includes(i)) bottom.push(cards[i])
else top.push(cards[i])

}

renderCombo(top,bottom)

let odds=odds5(cards,best,combo)

let name=""

if(odds===5) name="ğŸ‚ äº”ç‰›"
else if(odds===3 && best===1) name="ğŸ„ ç‰›å†¬è‡"
else if(best===10) name="ğŸ‚ ç‰›ç‰›"
else name="ç‰› "+best

result.textContent=name+" (èµ”ç‡ "+odds+"å€)"

aiBox.textContent="AIå·²é‡æ–°è®¡ç®—äº”å¼ ç‰Œ"

}

}

</script>

</body>
</html>
